# GARPIX_angle_detection

main.py: Это главный файл проекта. Чтобы запустить проект, запустите этот файл.



Block.py: Этот файл содержит класс Block, который представляет информацию о блоке. 
Содержит параметры: 
1. Id
2. Плотность
3. Длина
4. Ширина
5. Высота
6. X
7. Y
8. Z (если встать перед блоком, данные координаты относятся к переднему левому нижнему углу блока)
9. Масса
10. список с id всех блоков, опирающихся на него (blocks_above)
11. список с id всех блоков, на которые опирается данный блок (blocks_under)
12. список с id всех блоков, которые держат (непосредственно соприкасаясь) хотя бы один из блоков, который поддерживает (непосредственно соприкасаясь) данный блок (neighbor). Этот параметр необходим для случая, когда надо рассматривать конструкцию блоков (если они рздожены как кирпичная кладка).
13. коэффициент соприкосновения (какая часть площади блока непосредственно соприкасается с блоками ниже)
14. площадь соприкосновения с блоками ниже
15. коэффициент трения

Содержит встроенные функции:
добавления и удаления элементов из параметров 10, 11, 12, подсчета площади соприкосновения и коэффициента соприкосновения (параметры 13, 14), изменения массы (параметр 9)



data_transition.py: В этом файле данные передаются из CSV-файлов в массив экземпляров класса Block.
Используются следующие функции:
1. csv_to_array: функция для перевода из csv в обычный массив
2. sort_blocks_by_height: Функция для сортировки блоков от верхнего к нижнему (по координате z)
3. sort_blocks_by_id: Функция для сортировки блоков по возрастанию id
4. check_rectangle_intersection: функция проверяет, пересекаются ли прямоугольники (используются для определения опирается ди один блок на другой)
5. calculate_intersection_area: функция считает площадь пересечения прямоугольников
6. neighbour_detect: функция заполняет поле neighbour для каждого экземпляра класса Block 
7. id_positions: функция сначала вызывает функцию под номером 2 (заполнение данных должно происходить от самого верхнего блока к самому нижнему), затем выявляет на какие блоки опирается данный блок (если координата z данного блока совпадает с суммой координаты z  и высоты другого блока и функция 4 возвращает True, то опирается) и заполняет параметры blocks_above и blocks_under, вызывает функцию 3 (для удобства в дальнейшем), после вызывает функцию 6.



algoritms.py: В этом файле содержатся функции, ответственные за реализацию алгоритма определения угла падения.
Содержит функции:
1.	calculate_center_of_mass: функция выявляет координаты центра масс конструкции
2.	calculate_fall_angle: Функция берет высоту центра масс и делит ее на ширину или длину конструкции (в зависимости от того, что больше). После этого умножает на коэффициент соприкосновения (соотношение площади блока, которая соприкасается с нижними блоками ко всей площади блока) и на коэффициент отклонения (находится из положения координат x, y центра масс и средней точки опоры)
3.	find_intersection_center: функция находит центр площади соприкосновения двух блоков.
4.	find_average_support_point: функция использует результаты функции 3 для выявления средней точки опоры.
5.	detecting_construction: функция для каждого блока определяет какие блоки обязательно рассматривать вместе с ним (для этого рассматриваются все блоки над ним, а так же все блоки neighbor и их блоки сверху). Функция выявляет центр масс и среднюю точку опоры, с помощью функций 1, 3, 4, находит ширну и длину всей конструкции и передает данные в функцию 2. Функция возвращает наименьший из полученных углов.



visualisation.py: в файле реализован класс, который визуализирует положение коробок и угол падения.